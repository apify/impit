name: Check formatting & Clippy
on:
  push:
  pull_request:

permissions:
  contents: read

concurrency:
  group: deploy
  cancel-in-progress: false

jobs:
  fmt:
    name: Check code formatting
    runs-on: ubuntu-latest
    container: rust:slim
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Install rustfmt
        run: rustup component add rustfmt
      - name: Check formatting
        run: cargo fmt -- --check
  clippy:
    name: Check code style
    runs-on: ubuntu-latest
    container: rust:slim
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Install clippy
        run: rustup component add clippy
      - name: Check style
        run: cargo clippy -- -D warnings